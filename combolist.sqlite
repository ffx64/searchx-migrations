CREATE TABLE file_logs (
    id INTEGER PRIMARY KEY AUTOINCREMENT,            -- Identificador único do arquivo de log
    file_name TEXT NOT NULL,                          -- Nome do arquivo
    file_size INTEGER NOT NULL,                       -- Tamanho do arquivo em bytes
    file_hash TEXT NOT NULL,                          -- Hash do arquivo (SHA-256 por exemplo)
    created_at TEXT DEFAULT (DATE('now')),            -- Data de criação (somente a data, sem hora)
    processed_at TEXT,                                -- Data de processamento (somente a data)
    status TEXT DEFAULT 'pendente',                   -- Status do arquivo (pendente, processado, erro)
    source TEXT,                                      -- Fonte de onde o arquivo veio (opcional)
    file_type TEXT,                                   -- Tipo do arquivo (ex.: txt, csv, json)
    file_description TEXT,                            -- Descrição opcional do arquivo
    processed_entries_count INTEGER DEFAULT 0         -- Contagem de entradas processadas (para auditoria)
);

-- Adicionando índices para otimizar as buscas
CREATE INDEX IF NOT EXISTS idx_file_logs_file_hash ON file_logs(file_hash);
CREATE INDEX IF NOT EXISTS idx_file_logs_status ON file_logs(status);
CREATE INDEX IF NOT EXISTS idx_file_logs_created_at ON file_logs(created_at);

CREATE TABLE log_entries (
    id INTEGER PRIMARY KEY AUTOINCREMENT,             -- Identificador único da entrada de log
    file_log_id INTEGER NOT NULL,                      -- Chave estrangeira para o arquivo de log (tabela file_logs)
    url TEXT,                                          -- URL extraída do log
    username TEXT,                                     -- Nome de usuário extraído do log
    password TEXT,                                     -- Senha extraída do log
    log_data TEXT,                                     -- Texto bruto da entrada do log
    created_at TEXT DEFAULT (DATE('now')),             -- Data de criação da entrada de log (somente a data)
    processed_at TEXT,                                 -- Data de quando a entrada foi processada (somente a data)
    FOREIGN KEY (file_log_id) REFERENCES file_logs(id) -- Relacionamento com a tabela file_logs
);

-- Adicionando índices para otimizar as buscas
CREATE INDEX IF NOT EXISTS idx_log_entries_file_log_id ON log_entries(file_log_id);
CREATE INDEX IF NOT EXISTS idx_log_entries_created_at ON log_entries(created_at);

